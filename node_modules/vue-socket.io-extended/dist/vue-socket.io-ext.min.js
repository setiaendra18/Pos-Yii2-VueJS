!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueSocketIOExt=t()}(this,function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(o,!0).forEach(function(n){t(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function o(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e){return function(e){if(Array.isArray(e))return e}(e)||a(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var s=function(e){return"function"==typeof e},u=function(e){return e&&e.length<=1?e[0]:e},f=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce(function(e,t){return t(e)},e)}},l=function(e){return function(t){return e+t}},p=function(e,t,n){var r=e[t];e[t]=function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];r.call.apply(r,[e].concat(o)),n.apply(void 0,o)}},y=new(function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=new Map}var n,r,o;return n=t,(r=[{key:"addListener",value:function(e,t,n){s(t)&&(this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push({callback:t,vm:n}))}},{key:"removeListener",value:function(e,t,n){if(s(t)){var r=(this.listeners.get(e)||[]).filter(function(e){return e.callback!==t||e.vm!==n});r.length>0?this.listeners.set(e,r):this.listeners.delete(e)}}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.listeners.get(e)||[];o.forEach(function(e){var t;(t=e.callback).call.apply(t,[e.vm].concat(n))})}}])&&e(n.prototype,r),o&&e(n,o),t}()),v=function(e){return Object.keys(e._mutations)},h=function(e){return Object.keys(e._actions)},g=function(e){return e.split("/").pop()},b=function(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");t=Object.assign({pascalCase:!1},t);var n;return 0===(e=Array.isArray(e)?e.map(function(e){return e.trim()}).filter(function(e){return e.length}).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=function(e){for(var t=!1,n=!1,r=!1,o=0;o<e.length;o++){var i=e[o];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,o)+"-"+e.slice(o),t=!1,r=n,n=!0,o++):n&&r&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,o-1)+"-"+e.slice(o-1),r=n,n=!1,t=!0):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,r=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e}(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()}).replace(/\d+(\w|$)/g,function(e){return e.toUpperCase()}),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)},d=b,m=b;d.default=m;var w=Object.freeze({actionPrefix:"socket_",mutationPrefix:"SOCKET_",eventToMutationTransformer:function(e){return e.toUpperCase()},eventToActionTransformer:d}),O=["connect","error","disconnect","reconnect","reconnect_attempt","reconnecting","reconnect_error","reconnect_failed","connect_error","connect_timeout","connecting","ping","pong"];var j,k="undefined"!=typeof Proxy&&("function"==typeof(j=Proxy)&&/native code/.test(j.toString()));return{install:function(e,t,n){if(!((a=t)&&s(a.on)&&s(a.emit)))throw new Error("[vue-socket.io-ext] you have to pass `socket.io-client` instance to the plugin");var a;!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.store,a=o(t,["store"]),s=r({},w,{},a),b=f(s.eventToActionTransformer,l(s.actionPrefix)),d=f(s.eventToMutationTransformer,l(s.mutationPrefix));function m(e,t){if(n){var r=d(e),o=b(e),i=v(n),c=h(n),a=u(t);i.filter(function(e){return g(e)===r}).forEach(function(e){return n.commit(e,a)}),c.filter(function(e){return g(e)===o}).forEach(function(e){return n.dispatch(e,a)})}}function j(){p(e,"onevent",function(e){var t=i(e.data),n=t[0],r=t.slice(1);y.emit.apply(y,[n].concat(c(r))),m(n,r)}),O.forEach(function(t){e.on(t,function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];y.emit.apply(y,[t].concat(n)),m(t,n)})})}j()}(t,n),e.prototype.$socket=t,e.mixin(function(e){return{created:function(){var t=this,n=this.$options.sockets,r=void 0===n?{}:n;Object.keys(r).forEach(function(n){e.addListener(n,r[n],t)}),k&&(this.$options.sockets=new Proxy(r,{set:function(n,r,o){return e.addListener(r,o,t),n[r]=o,!0},deleteProperty:function(n,r){return e.removeListener(r,t.$options.sockets[r],t),delete n[r],!0}}))},beforeDestroy:function(){var t=this,n=this.$options.sockets,r=void 0===n?{}:n;Object.keys(r).forEach(function(n){k||e.removeListener(n,r[n],t),delete t.$options.sockets[n]})}}}(y));var b=e.config.optionMergeStrategies;b.sockets=b.methods},defaults:w}});
